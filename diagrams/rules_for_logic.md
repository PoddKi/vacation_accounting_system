# Бизнес-правила системы "График отпусков"

| №  | Правило                              | Условие / Описание                                                                 | Кто проверяет     | Где реализуется                             |
|----|--------------------------------------|-------------------------------------------------------------------------------------|--------------------|----------------------------------------------|
| 1  | Максимум дней отпуска                | Суммарно за год не более **28 календарных дней**                                   | Сервер (BLL)       | При сохранении отпуска                      |
| 2  | Минимум один отрезок 14+ дней        | Один период отпуска должен быть **не менее 14 календарных дней**                   | Сервер (BLL)       | При сохранении отпуска                      |
| 3  | Заместитель доступен                 | Заместитель не должен быть в отпуске в указанный период                            | Сервер (BLL + БД)  | При выборе/сохранении отпуска               |
| 4  | Заместитель не дублируется           | Заместитель не должен быть назначен у другого сотрудника на эти даты               | Сервер (BLL + БД)  | При планировании                            |
| 5  | 30% сотрудников одновременно         | Не более **30% сотрудников** отдела одновременно в отпуске                         | Сервер (BLL + БД)  | При планировании                            |
| 6  | Планирование в установленный срок    | График редактируется **с 1 октября по 15 ноября**, либо вручную открыт отделом кадров | Сервер + UI        | При редактировании                          |
| 7  | Вручное открытие графика             | Отдел кадров может вручную открыть/закрыть график                                  | UI + Сервер        | Интерфейс + API                             |
| 8  | Только авторизованные пользователи   | Анонимный доступ запрещён                                                         | Middleware + Auth  | ASP.NET Identity                            |
| 9  | Ограничение доступа по ролям         | Доступ к функциям ограничен ролями (пользователь, руководитель и т.д.)             | UI + Сервер        | Role-based Access в Blazor                  |
| 10 | Отчётность в формате Excel           | Все отчёты выгружаются в **.xlsx**                                                 | Сервер             | Сервис экспорта (например, EPPlus)          |
| 11 | Проблемные отпуска                   | Уведомления о: <br>– менее/более 28 дней отпуска <br>– нет 14-дневного отрезка     | Сервер             | Выгрузка отчёта                             |
| 12 | Уведомление за 3 дня до отпуска      | Сотрудник получает e-mail **за 3 дня до начала отпуска**                           | Фоновый сервис     | `IHostedService` + SMTP                     |
| 13 | Журнал действий                      | Запись всех действий пользователей (кто, что, когда)                               | Сервер             | Middleware + таблица `AuditLog`             |

---

## Примечания

- Все проверки **должны быть продублированы** на серверной стороне — вне зависимости от UI.
- Для проверки по количеству сотрудников и отпусков — используем **LINQ-запросы к БД**.
- Уведомления реализуются через фоновые задачи в ASP.NET (`IHostedService`).

